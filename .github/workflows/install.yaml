name: Brew install tests

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

permissions:
  contents: read

jobs:
  install_casks:
    name: Install ${{ matrix.cask }} cask on ${{ matrix.macos }}
    strategy:
      matrix:
        macos:
          - macos-13
          - macos-14
          - macos-15
          - macos-15-intel
          - macos-26
    env:
      HOMEBREW_LOGS: ~/homebrew-logs
      HOMEBREW_TEMP: ~/homebrew-temp
      HOMEBREW_NO_AUTO_UPDATE: 1
    runs-on: ${{ matrix.macos }}
    steps:
      - uses: actions/checkout@v6
        with:
          fetch-depth: 0
      - name: Create a temporary tap
        run: brew tap local/test .
      - name: Install openvox-agent-8 cask
        run: brew install --display-times --verbose --cask openvox-agent-8
      - name: Uninstall openvox-agent-8 cask
        run: brew uninstall --verbose --cask openvox-agent-8
